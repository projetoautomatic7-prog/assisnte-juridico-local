name: "Copilot Setup Steps"

# Automaticamente executa as etapas de configuraÃ§Ã£o quando sÃ£o alteradas para permitir
# validaÃ§Ã£o fÃ¡cil, e permite testes manuais atravÃ©s da aba "Actions" do repositÃ³rio
on:
  workflow_dispatch:
  push:
    paths:
      - .github/workflows/copilot-setup-steps.yml
  pull_request:
    paths:
      - .github/workflows/copilot-setup-steps.yml

concurrency:
  group: copilot-setup-steps-${{ github.ref }}
  cancel-in-progress: true

jobs:
  # O job DEVE ser chamado `copilot-setup-steps` ou nÃ£o serÃ¡ reconhecido pelo Copilot.
  copilot-setup-steps:
    runs-on: ubuntu-latest
    timeout-minutes: 15

    # Define as permissÃµes para o mÃ­nimo necessÃ¡rio.
    # O Copilot receberÃ¡ seu prÃ³prio token para suas operaÃ§Ãµes.
    permissions:
      # NecessÃ¡rio para clonar o repositÃ³rio e instalar dependÃªncias
      contents: read

    # VocÃª pode definir quaisquer steps que desejar, e eles serÃ£o executados antes do agente iniciar.
    # Se vocÃª nÃ£o fizer checkout do cÃ³digo, o Copilot farÃ¡ isso automaticamente para vocÃª.
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "22"
          cache: "npm"
          cache-dependency-path: package-lock.json

      - name: Install JavaScript dependencies
        run: npm ci

      - name: Validate setup
        run: |
          echo "âœ… Copilot setup steps completed successfully"
          echo "ğŸ“¦ Dependencies installed: $(npm list --depth=0 | wc -l) packages"
          echo "ğŸ”§ Node version: $(node --version)"
          echo "ğŸ“‹ NPM version: $(npm --version)"
          echo "ğŸ¯ Setup validation passed"
