name: Sync to GitLab

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  sync:
    name: ğŸ”„ Sync to GitLab
    runs-on: ubuntu-latest
    # NÃ£o sincronizar commits de badges para evitar loop
    if: ${{ !contains(github.event.head_commit.message, '[skip ci]') }}
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ğŸ”„ Push to GitLab
        env:
          GITLAB_TOKEN: ${{ secrets.GITLAB_TOKEN || '' }}
        run: |
          if [ -z "$GITLAB_TOKEN" ]; then
            echo "âš ï¸ GITLAB_TOKEN nÃ£o configurado - pulando sincronizaÃ§Ã£o"
            exit 0
          fi
          
          echo "ğŸ”„ Sincronizando GitHub â†’ GitLab..."
          git remote add gitlab https://oauth2:${GITLAB_TOKEN}@gitlab.com/thiagobodevan-a11y-group/assistente-juridico-p.git || true
          git push gitlab main --force
          echo "âœ… SincronizaÃ§Ã£o concluÃ­da!"
